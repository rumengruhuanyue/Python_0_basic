## 同步原语

### 信号量

python中信号量操作方法：
> **`.acquire()`** // 请求使用临界资源，执行信号量减少1，并判断是否阻塞当前的进程（线程），放入阻塞队列。// **对应P操作**
>
> **`.release()`** // 当前进程（线程）使用完临界资源，这个时候信号量为负数，其绝对值表示阻塞队列中卡住等待使用临界资源的进程（线程）。此时信号量加1,唤醒阻塞队列中的一个进程让其进入就绪状态，可以让其使用临界资源. // **对应V操作**

#### 关于PV操作容易产生的一些疑问：

**1. S大于0那就表示有临界资源可供使用，为什么不唤醒进程？**

答：S大于0的确表示有临界资源可供使用，也就是说这个时候没有进程被阻塞在这个资源上，所以不需要唤醒。

**2. S小于0应该是说没有临界资源可供使用，为什么还要唤醒进程？**

答：V原语操作的本质在于：一个进程使用完临界资源后，释放临界资源，使S加1，以通知其它的进程，这个时候如果S<0，表明有进程阻塞在该类资源上，因此要从阻塞队列里唤醒一个进程来“转手”该类资源。比如，有两个某类资源，四个进程A、B、C、D要用该类资源，最开始S=2，当A进入，S=1，当B进入S=0，表明该类资源刚好用完， 当C进入时S=-1，表明有一个进程被阻塞了，D进入，S=-2。当A用完该类资源时，进行V操作，S=-1，释放该类资源，因为S<0，表明有进程阻塞在该类资源上，于是唤醒一个。

**3. 如果是互斥信号量的话，应该设置信号量S=1，但是当有5个进程都访问的话，最后在该信号量的链表里会有4个在等待，也是说S=-4，那么第一个进程执行了V操作使S加1，释放了资源，下一个应该能够执行，但唤醒的这个进程在执行P操作时因S<0，也还是执行不了，这是怎么回事呢？**

答：当一个进程阻塞了的时候，它已经执行过了P操作，并卡在临界区那个地方。当唤醒它时就立即进入它自己的临界区，并不需要执行P操作了，当执行完了临界区的程序后，就执行V操作。

**4. S的绝对值表示等待的进程数，同时又表示临界资源，这到底是怎么回事？**

答：当信号量S小于0时，其绝对值表示系统中因请求该类资源而被阻塞的进程数目.S大于0时表示可用的临界资源数。注意在不同情况下所表达的含义不一样。当等于0时，表示刚好用完。

在最后，我们可以发现，我们是严格按照之前的PV操作的定义执行的，其实我们身边很多例子都是这样一步步实现的，只要多发现，用这种计算机思想来思考，是可以得到很多锻炼的。


### 引用

* [PV操作示例详解](https://blog.csdn.net/wuxy720/article/details/78936912)
* [PV原语操作详解](https://www.cnblogs.com/xzh31390080/p/4390058.html)